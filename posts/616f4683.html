<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>前端性能优化 | Leslie Waong</title><meta name="keywords" content="性能优化"><meta name="author" content="Leslie Waong"><meta name="copyright" content="Leslie Waong"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="前端性能优化 作者：黑色的枫链接：https:&#x2F;&#x2F;juejin.cn&#x2F;post&#x2F;6904517485349830670来源：稀土掘金著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。  重要性当我们面试的时候，前端性能优化方面算是必考的知识点，但是工作中我们又很少会重点的对项目进行前端优化，它真的不重要吗？ 如果我们可以将后端响应时间缩短一半，整体响应时间只能减少5%~10%。而"><meta property="og:type" content="article"><meta property="og:title" content="前端性能优化"><meta property="og:url" content="https://lesliewaong.top/posts/616f4683.html"><meta property="og:site_name" content="Leslie Waong"><meta property="og:description" content="前端性能优化 作者：黑色的枫链接：https:&#x2F;&#x2F;juejin.cn&#x2F;post&#x2F;6904517485349830670来源：稀土掘金著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。  重要性当我们面试的时候，前端性能优化方面算是必考的知识点，但是工作中我们又很少会重点的对项目进行前端优化，它真的不重要吗？ 如果我们可以将后端响应时间缩短一半，整体响应时间只能减少5%~10%。而"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Lesliewaong/Lesliewaong.github.io/img/5.jpg"><meta property="article:published_time" content="2022-02-10T06:32:42.000Z"><meta property="article:modified_time" content="2022-03-21T14:54:17.979Z"><meta property="article:author" content="Leslie Waong"><meta property="article:tag" content="性能优化"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/Lesliewaong/Lesliewaong.github.io/img/5.jpg"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/Lesliewaong/Lesliewaong.github.io/img/avatar.jpg"><link rel="canonical" href="https://lesliewaong.top/posts/616f4683"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"search.xml",languages:{hits_empty:"找不到您查询的内容：${query}"}},translate:{defaultEncoding:2,translateDelay:0,msgToTraditionalChinese:"繁",msgToSimplifiedChinese:"簡"},noticeOutdate:{limitDay:365,position:"top",messagePrev:"一年之内的产物",messageNext:"技术可能存在过期"},highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:200},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"天",date_suffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:{limitCount:50,languages:{author:"作者: Leslie Waong",link:"链接: ",source:"来源: Leslie Waong",info:"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},lightbox:"fancybox",Snackbar:{chs_to_cht:"你已切换为繁体",cht_to_chs:"你已切换为简体",day_to_night:"你已切换为深色模式",night_to_day:"你已切换为浅色模式",bgLight:"#49b1f5",bgDark:"#121212",position:"bottom-left"},source:{jQuery:"https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js",justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js",css:"https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css"},fancybox:{js:"https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js",css:"https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"}},isPhotoFigcaption:!1,islazyload:!0,isanchor:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"前端性能优化",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2022-03-21 22:54:17"}</script><noscript><style type="text/css">#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,o){if(0===o)return;const n=864e5*o,a={value:t,expiry:(new Date).getTime()+n};localStorage.setItem(e,JSON.stringify(a))},get:function(e){const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!((new Date).getTime()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=e=>new Promise((t,o)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=o,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,t())},document.head.appendChild(n)}),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme");"dark"===t?activateDarkMode():"light"===t&&activateLightMode();const o=saveToLocal.get("aside-status");void 0!==o&&("hide"===o?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));const n=saveToLocal.get("global-font-size");void 0!==n&&document.documentElement.style.setProperty("--global-font-size",n+"px");const a=()=>{GLOBAL_CONFIG_SITE.isHome&&/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")};a(),document.addEventListener("pjax:complete",a)})(window)</script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Leslie Waong" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://cdn.jsdelivr.net/gh/Lesliewaong/Lesliewaong.github.io/img/avatar.jpg" onerror='onerror=null,src="https://cdn.jsdelivr.net/gh/Lesliewaong/Lesliewaong.github.io/img/friend_404.gif"' alt="avatar"></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">46</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">99</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-archive"></i><span> 归档</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/artitalk/"><i class="fa-fw fas fa-book"></i><span> 说说</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时轴</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-heartbeat"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/List/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/List/gallery/"><i class="fa-fw fa fa-image"></i><span> 相册</span></a></li><li><a class="site-page child" href="/List/movies/"><i class="fa-fw fa fa-film"></i><span> 视频</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/tools/"><i class="fa-fw fa fa-suitcase"></i><span> 百宝箱</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-book"></i><span> 项目</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/item/Naruto/"><i class="fa-fw fa fa-star"></i><span> 火影</span></a></li><li><a class="site-page child" href="/react-admin-client"><i class="fa-fw fa fa-star"></i><span> One Piece</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/bangumis/"><i class="fa-fw fa fa-desktop"></i><span> BiliBili</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于我</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(https://cdn.jsdelivr.net/gh/Lesliewaong/Lesliewaong.github.io/img/5.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Leslie Waong</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-archive"></i><span> 归档</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/artitalk/"><i class="fa-fw fas fa-book"></i><span> 说说</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时轴</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-heartbeat"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/List/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/List/gallery/"><i class="fa-fw fa fa-image"></i><span> 相册</span></a></li><li><a class="site-page child" href="/List/movies/"><i class="fa-fw fa fa-film"></i><span> 视频</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/tools/"><i class="fa-fw fa fa-suitcase"></i><span> 百宝箱</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-book"></i><span> 项目</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/item/Naruto/"><i class="fa-fw fa fa-star"></i><span> 火影</span></a></li><li><a class="site-page child" href="/react-admin-client"><i class="fa-fw fa fa-star"></i><span> One Piece</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/bangumis/"><i class="fa-fw fa fa-desktop"></i><span> BiliBili</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于我</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">前端性能优化</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-02-10T06:32:42.000Z" title="发表于 2022-02-10 14:32:42">2022-02-10</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-03-21T14:54:17.979Z" title="更新于 2022-03-21 22:54:17">2022-03-21</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%92%8C%E6%B5%8F%E8%A7%88%E5%99%A8/">计算机网络和浏览器</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">5.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>17分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="前端性能优化"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="前端性能优化"><a href="#前端性能优化" class="headerlink" title="前端性能优化"></a>前端性能优化</h1><blockquote><p>作者：黑色的枫<br>链接：<a target="_blank" rel="noopener" href="https://juejin.cn/post/6904517485349830670">https://juejin.cn/post/6904517485349830670</a><br>来源：稀土掘金<br>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p></blockquote><h2 id="重要性"><a href="#重要性" class="headerlink" title="重要性"></a>重要性</h2><p>当我们面试的时候，前端性能优化方面算是必考的知识点，但是工作中我们又很少会重点的对项目进行前端优化，它真的不重要吗？</p><p><code>如果我们可以将后端响应时间缩短一半，整体响应时间只能减少5%~10%。而如果关注前端性能，同样是将其响应时间减少一半，则整体响应时间可以减少40%~45%。</code></p><p>改进前端通常只需要较少的时间和资源，减少后端延迟会带来很大的改动。</p><p><code>只有10%~20%的最终用户响应时间花在了下载HTML文档上，其余的80%~90%时间花在了下载页面中的所有组件上。</code></p><h2 id="定位"><a href="#定位" class="headerlink" title="定位"></a>定位</h2><h3 id="技术上的选择"><a href="#技术上的选择" class="headerlink" title="技术上的选择"></a>技术上的选择</h3><p>在前端日常开发中，技术上的选择是非常重要的。为什么要讲这个呢？因为现象频发。</p><p>前端工程化严重的当下，轻量化的框架慢慢被遗忘掉了。并不是所有的业务场景都适合使用工程化框架，<strong>react/vue 并不轻量</strong>。</p><blockquote><p>复杂的框架是为了解决复杂的业务</p></blockquote><p>如果研发h5、PC展示等场景简单的业务时候，javascript原生 配合一些轻量化插件更适合。</p><p>多页面应用也并不都是缺点。根据业务不同而选择不一样的技术是非常重要的，是每个前端都应该反思的事情。</p><p>这方面是导致卡顿的关键问题。</p><h3 id="NetWork"><a href="#NetWork" class="headerlink" title="NetWork"></a>NetWork</h3><p>我们的老朋友NetWork想必前端同学都很熟悉。我们先来看一下network面板</p><p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qeLtoQ"><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://s1.ax1x.com/2022/03/20/qeLtoQ.png" alt="qeLtoQ.png"></a></p><p>从面板上我们可以看出一些信息：</p><ul><li>请求资源size</li><li>请求资源时长</li><li>请求资源数量</li><li>接口响应时长</li><li>接口发起数量</li><li>接口报文size</li><li>接口响应状态</li><li>瀑布图</li></ul><p><strong>瀑布图</strong>是什么呢？</p><p>瀑布图就是上方图片后面的<strong>waterfall</strong>纵列</p><p>瀑布图是一个级联图, 展示了浏览器如何加载资源并渲染成网页. 图中的每一行都是一次单独的浏览器请求. 这个图越长, 说明加载网页过程中所发的请求越多. 每一行的宽度, 代表浏览器发出请求并下载该资源的过程中所耗费的时间。它的侧重点在于分析网路链路</p><p>瀑布图颜色说明：</p><ul><li><strong>DNS Lookup</strong> [深绿色] - 在浏览器和服务器进行通信之前, 必须经过DNS查询, 将域名转换成IP地址. 在这个阶段, 你可以处理的东西很少. 但幸运的是, 并非所有的请求都需要经过这一阶段。</li><li><strong>Initial Connection</strong> [橙色] - 在浏览器发送请求之前, 必须建立<strong>TCP</strong>连接. 这个过程仅仅发生在瀑布图中的开头几行, 否则这就是个性能问题(后边细说)。</li><li><strong>SSL/TLS Negotiation</strong> [紫色] - 如果你的页面是通过<strong>SSL/TLS</strong>这类安全协议加载资源, 这段时间就是浏览器建立安全连接的过程。目前Google将HTTPS作为其搜索排名因素 之一, SSL/TLS 协商的使用变得越来越普遍了。</li><li><strong>Time To First Byte (TTFB)</strong> [绿色] - <strong>TTFB 是浏览器请求发送到服务器的时间+服务器处理请求时间+响应报文的第一字节到达浏览器的时间</strong>。 我们用这个指标来判断你的web服务器是否性能不够, 或者说你是否需要使用CDN。</li><li><strong>Downloading (蓝色)</strong> - 这是浏览器用来下载资源所用的时间. 这段时间越长, 说明资源越大. 理想情况下, 你可以通过控制资源的大小来控制这段时间的长度。</li></ul><p>那么除了瀑布图的长度外，我们如何才能判断一个瀑布图的状态是<strong>健康</strong>的呢？</p><ul><li>首先, 减少所有资源的加载时间. 亦即减小瀑布图的宽度。 瀑布图越窄, 网站的访问速度越快。</li><li>其次, 减少请求数量，也就是降低瀑布图的高度。瀑布图越矮越好。</li><li>最后, 通过优化资源请求顺序来加快渲染时间。从图上看, 就是将绿色的”开始渲染”线向左移。这条线向左移动的越远越好。</li></ul><p>这样，我们就可以从network的角度去排查“慢”的问题。</p><p><strong>蓝线</strong>表示 DOMReady 事件。事件触发的条件是：浏览器已经把整个 HTML 文档的 DOM 结构解析完毕。一般前端开发者监听这个事件是为了可靠地在文档中查找元素。这个事件触发之前有可能只下载了半截 HTML，想要的元素还没出现。</p><p><strong>红线</strong>表示 load 事件，触发条件是：整个页面的 JS CSS 图片都下载完毕。用户看到的进度条/小菊花已经不再显示为 “忙” 的状态。是用户眼中的加载完毕。</p><h3 id="webpack-bundle-analyzer"><a href="#webpack-bundle-analyzer" class="headerlink" title="webpack-bundle-analyzer"></a>webpack-bundle-analyzer</h3><p>项目构建后生成的bundle包是压缩后的。webpack-bundle-analyzer是一款包分析工具。</p><h3 id="Performance"><a href="#Performance" class="headerlink" title="Performance"></a>Performance</h3><p>chrome自带的performance模块。先附上一个官网文档传送门：<a href="https://link.juejin.cn/?target=https://developers.google.com/web/tools/chrome-devtools/evaluate-performance/?utm_source=devtools">Performance</a></p><p>可以检测很多方面的数据，多数情况的性能排查上用的比较多。如果想要深入了解的同学建议去看一下官方文档。</p><p>接下来我们来说一下在performance面板中如何排差“慢”的问题，它给我们提供了哪些信息呢。先附上一张performance的面板图片。<br><a target="_blank" rel="noopener" href="https://imgtu.com/i/qeLYdg"><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://s1.ax1x.com/2022/03/20/qeLYdg.png" alt="qeLYdg.png"></a></p><p>从上图中可以分析出一些指标</p><ul><li>FCP/LCP 时间是否过长？</li><li>请求并发情况 是否并发频繁？</li><li>请求发起顺序 请求发起顺序是否不对？</li><li>javascript执行情况 javascript执行是否过慢？</li></ul><p>这些指标就是我们需要重点关注的，当然performance的功能并不止于此。</p><p>先记住如何获取到这些指标，后面来一一进行解析优化。</p><h3 id="PerformanceNavigationTiming"><a href="#PerformanceNavigationTiming" class="headerlink" title="PerformanceNavigationTiming"></a>PerformanceNavigationTiming</h3><p>获取各个阶段的响应时间，我们所要用到的接口是<strong>PerformanceNavigationTiming</strong>接口。</p><p><strong>关于我们的Web性能，我们会用到的时间参数：</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">DNS解析时间： domainLookupEnd - domainLookupStart</span><br><span class="line">TCP建立连接时间： connectEnd - connectStart</span><br><span class="line">白屏时间： responseStart - navigationStart</span><br><span class="line">dom渲染完成时间： domContentLoadedEventEnd - navigationStart</span><br><span class="line">页面onload时间： loadEventEnd - navigationStart</span><br></pre></td></tr></table></figure><p>根据这些时间参数，我们就可以判断哪一阶段对性能有影响。</p><h3 id="抓包"><a href="#抓包" class="headerlink" title="抓包"></a>抓包</h3><p>有一些业务状况是没有上述的一些调试工具该怎么办呢？我们可以利用抓包工具进行对页面信息对抓取，上述我们通过chrome工具排查出来的指标，也可以通过抓包工具进行抓取。</p><p>这里我推荐一款抓包工具<a href="https://link.juejin.cn/?target=https://www.charlesproxy.com/">charles</a>。</p><h3 id="性能测试工具"><a href="#性能测试工具" class="headerlink" title="性能测试工具"></a>性能测试工具</h3><p>Pingdom</p><p>Load Impact</p><p>WebPage Test</p><p>Octa Gate Site Timer</p><p>Free Speed Test</p><h2 id="优化"><a href="#优化" class="headerlink" title="优化"></a>优化</h2><p>前端的优化种类繁多，主要包含三个方面的优化：网络优化（对加载时所消耗的网络资源优化），代码优化（资源加载完后，脚本解释执行的速度），框架优化（选择性能较好的框架，比如<a href="https://link.juejin.cn/?target=https://link.zhihu.com/?target=https://stefankrause.net/js-frameworks-benchmark8/table.html">benchmark</a>）。</p><h3 id="tree-shaking"><a href="#tree-shaking" class="headerlink" title="tree shaking"></a>tree shaking</h3><p>中文（摇树），webpack构建优化中重要一环。摇树用于清除我们项目中的一些无用代码，它依赖于ES中的模块语法。</p><p>比如日常使用lodash的时候</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> _ <span class="keyword">from</span> <span class="string">&#x27;lodash&#x27;</span></span><br></pre></td></tr></table></figure><p>如果如上引用lodash库，在构建包的时候是会把整个lodash包打入到我们的bundle包中的。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> _isEmpty <span class="keyword">from</span> <span class="string">&#x27;lodash/isEmpty&#x27;</span>;</span><br></pre></td></tr></table></figure><p>如果如上引用lodash库，在构建包的时候只会把isEmpty这个方法抽离出来再打入到我们的bundle包中。</p><p>这样的化就会大大减少我们包的size。所以在日常引用第三方库的时候，需要注意导入的方式。</p><p>如何开启摇树</p><p>在webpack4.x 中默认对tree-shaking进行了支持。 在webpack2.x 中使用tree-shaking：<a href="https://link.juejin.cn/?target=https://zhuanlan.zhihu.com/p/28725181">传送门</a></p><h3 id="split-chunks"><a href="#split-chunks" class="headerlink" title="split chunks"></a>split chunks</h3><p>中文（分包）</p><p>在没配置任何东西的情况下，webpack 4 就智能的帮你做了代码分包。入口文件依赖的文件都被打包进了main.js，那些大于 30kb 的第三方包，如：echarts、xlsx、dropzone等都被单独打包成了一个个独立 bundle。</p><p>其它被我们设置了异步加载的页面或者组件变成了一个个chunk，也就是被打包成独立的bundle。</p><p>它内置的代码分割策略是这样的：</p><ul><li>新的 chunk 是否被共享或者是来自 node_modules 的模块</li><li>新的 chunk 体积在压缩之前是否大于 30kb</li><li>按需加载 chunk 的并发请求数量小于等于 5 个</li><li>页面初始加载时的并发请求数量小于等于 3 个</li></ul><p>大家可以根据自己的项目环境来更改配置。配置代码如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">splitChunks(&#123;</span><br><span class="line">  <span class="attr">cacheGroups</span>: &#123;</span><br><span class="line">    <span class="attr">vendors</span>: &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">`chunk-vendors`</span>,</span><br><span class="line">      <span class="attr">test</span>: <span class="regexp">/[\\/]node_modules[\\/]/</span>,</span><br><span class="line">      priority: -<span class="number">10</span>,</span><br><span class="line">      <span class="attr">chunks</span>: <span class="string">&#x27;initial&#x27;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">dll</span>: &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">`chunk-dll`</span>,</span><br><span class="line">      <span class="attr">test</span>: <span class="regexp">/[\\/]bizcharts|[\\/]\@antv[\\/]data-set/</span>,</span><br><span class="line">      priority: <span class="number">15</span>,</span><br><span class="line">      <span class="attr">chunks</span>: <span class="string">&#x27;all&#x27;</span>,</span><br><span class="line">      <span class="attr">reuseExistingChunk</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">common</span>: &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">`chunk-common`</span>,</span><br><span class="line">      <span class="attr">minChunks</span>: <span class="number">2</span>,</span><br><span class="line">      <span class="attr">priority</span>: -<span class="number">20</span>,</span><br><span class="line">      <span class="attr">chunks</span>: <span class="string">&#x27;all&#x27;</span>,</span><br><span class="line">      <span class="attr">reuseExistingChunk</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>没有使用webpack4.x版本的项目，依然可以通过<strong>按需加载</strong>的形式进行分包，使得我们的包分散开，提升加载性能。</p><p>按需加载也是以前分包的重要手段之一</p><p>这里推荐一篇非常好的文章：<a target="_blank" rel="noopener" href="https://juejin.cn/post/6844903718387875847">webpack如何使用按需加载</a></p><h3 id="拆包"><a href="#拆包" class="headerlink" title="拆包"></a>拆包</h3><p>与3.2的分包不同。大家可能没发现，上面2.3的bundle包解析中有个有趣的现象，上面项目的技术栈是react，但是bundle包中并没有react、react-dom、react-router等。</p><p>因为把这些插件“拆”开了。并没有一起打在bundle中。而是放在了CDN上。下面我举一个例子来解释一下。</p><p>假设：原本bundle包为2M，一次请求拉取。拆分为 bundle（1M） + react桶（CDN）（1M） 两次请求并发拉取。</p><p>从这个角度来看，1+1的模式拉取资源更快。</p><p>换一个角度来说，全量部署项目的情况，每次部署bundle包都将重新拉取。比较浪费资源。react桶的方式可以命中强缓存，这样的化，就算全量部署也只需要重新拉取左侧1M的bundle包即可，节省了服务器资源。优化了加载速度。</p><p>注意：在本地开发过程中，react等资源建议不要引入CDN，开发过程中刷新频繁，会增加CDN服务其压力，走本地就好。</p><h3 id="gzip⭐"><a href="#gzip⭐" class="headerlink" title="gzip⭐"></a>gzip⭐</h3><p>服务端配置gzip压缩后可大大缩减资源大小。</p><p>Nginx配置方式</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">http &#123;</span><br><span class="line">  gzip on;</span><br><span class="line">  gzip_buffers <span class="number">32</span> 4K;</span><br><span class="line">  gzip_comp_level <span class="number">6</span>;</span><br><span class="line">  gzip_min_length <span class="number">100</span>;</span><br><span class="line">  gzip_types application/javascript text/css text/xml;</span><br><span class="line">  gzip_disable <span class="string">&quot;MSIE [1-6]\.&quot;</span>;</span><br><span class="line">  gzip_vary on;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>配置完成后在response header中可以查看。</p><h3 id="图片压缩⭐"><a href="#图片压缩⭐" class="headerlink" title="图片压缩⭐"></a>图片压缩⭐</h3><p>开发中比较重要的一个环节，我司自己的图床工具是自带压缩功能的，压缩后直接上传到CDN上。</p><p>如果公司没有图床工具，我们该如何压缩图片呢？我推荐几种我常用的方式</p><ul><li><a target="_blank" rel="noopener" href="https://tinypng.com/">tinypng</a>(免费、批量、速度块)</li><li>fireworks工具压缩像素点和尺寸 (自己动手，掌握尺度)</li><li>找UI压缩后发给你</li></ul><p>图片压缩是常用的手法，因为设备像素点的关系，UI给予的图片一般都是 x2，x4的，所以压缩就非常有必要。</p><h3 id="图片分割"><a href="#图片分割" class="headerlink" title="图片分割"></a>图片分割</h3><p>如果页面中有一张效果图，比如真机渲染图，UI手拿着刀不让你压缩。这时候不妨考虑一下分割图片。</p><p>建议单张土图片的大小不要超过100k，我们在分割完图片后，通过布局再拼接在一起。可以图片加载效率。</p><p>这里注意一点，分割后的每张图片一定要给height，否则网速慢的情况下样式会塌陷。</p><h3 id="sprite"><a href="#sprite" class="headerlink" title="sprite"></a>sprite</h3><p>南方叫精灵图，北方叫雪碧图。这个现象就很有趣。</p><p>在网站中有很多小图片的时候，一定要把这些小图片合并为一张大的图片，然后通过background分割到需要展示的图片。</p><p>这样的好处是什么呢？先来普及一个规则</p><p>浏览器请求资源的时候，同源域名请求资源的时候有最大并发限制，chrome为6个，就比如你的页面上有10个相同CDN域名小图片，那么需要发起10次请求去拉取，分两次并发。第一次并发请求回来后，发起第二次并发。</p><p>如果你把10个小图片合并为一张大图片的画，那么只用一次请求即可拉取下来10个小图片的资源。减少服务器压力，减少并发，减少请求次数。</p><h3 id="CDN⭐"><a href="#CDN⭐" class="headerlink" title="CDN⭐"></a>CDN⭐</h3><p>中文（内容分发网络），服务器是中心化的，CDN是“去中心化的”。</p><p>在项目中有很多东西都是放在CDN上的，比如：静态文件，音频，视频，js资源，图片。那么为什么用CDN会让资源加载变快呢？</p><p>举个简单的例子：</p><blockquote><p>以前买火车票大家都只能去火车站买，后来我们买火车票就可以在楼下的火车票代售点买了。</p></blockquote><p>你细品。</p><p>所以静态资源度建议放在CDN上，可以加快资源加载的速度。</p><p><a target="_blank" rel="noopener" href="https://mazhuang.org/2020/05/01/cdn-for-github-pages/?mode=light">使用 jsDelivr 免费加速 GitHub Pages 博客的静态资源</a></p><p><a target="_blank" rel="noopener" href="https://mazhuang.org/2020/10/07/cdn-for-github-pages-2/">使用 jsDelivr 免费加速 GitHub Pages 博客的静态资源（二）</a></p><h3 id="懒加载⭐"><a href="#懒加载⭐" class="headerlink" title="懒加载⭐"></a>懒加载⭐</h3><p>懒加载也叫延迟加载，指的是在长网页中延迟加载图像，是一种非常好的优化网页性能的方式。</p><p>当可视区域没有滚到资源需要加载的地方时候，可视区域外的资源就不会加载。</p><p>可以减少服务器负载，常适用于图片很多，页面较长的业务场景中。</p><p>如何使用懒加载呢？</p><ul><li><a target="_blank" rel="noopener" href="https://juejin.cn/post/6844903688390049800">图片懒加载</a></li><li><a href="https://link.juejin.cn/?target=https://github.com/callmecavs/layzr.js">layzr.js</a></li><li>img的loading属性</li></ul><h3 id="iconfont⭐"><a href="#iconfont⭐" class="headerlink" title="iconfont⭐"></a>iconfont⭐</h3><p>中文（字体图表），现在比较流行的一种用法。使用字体图表有几种好处</p><ul><li>矢量</li><li>轻量</li><li>易修改</li><li>不占用图片资源请求。</li></ul><p>就像上面说的雪碧图，如果都用字体图标来替换的画，一次请求都免了，可以直接打到bundle包中。</p><p>使用前提是UI给点力，设计趋向于字体图标，提前给好资源，建立好字体图标库。</p><h3 id="逻辑后移"><a href="#逻辑后移" class="headerlink" title="逻辑后移"></a>逻辑后移</h3><p>逻辑后移是一种比较常见的优化手段。用一个打开文章网站的操作来举个例子。</p><p>页面的展示主体是<strong>文章展示</strong>，如果文章展示的请求靠后了，那么渲染文章出来的时间必然靠后，因为有可能因为请求阻塞等情况，影响请求响应情况，如果超过一次并发的情况的话，会更加的慢。如图的这种情况也是在我们项目中发生过的。</p><p>很明显我们应该把主体“请求文章”接口前移，把一些非主体的请求逻辑后移。这样的话可以尽快的把主体渲染出来，就会快很多。</p><p>在平常的开发中建议时常注意逻辑后移的情况，突出主体逻辑。可以极大的提升用户体验。</p><h3 id="算法复杂度⭐"><a href="#算法复杂度⭐" class="headerlink" title="算法复杂度⭐"></a>算法复杂度⭐</h3><p>在数据量大的应用场景中，需要着重注意算法复杂度问题。</p><p>如上面Performance解析出的Javascript执行指标上，可以推测出来你的code执行效率如何，如果执行时间过长就要考虑一下是否要优化一下复杂度了。</p><blockquote><p>在时间换空间，空间换时间的选择上，要根据业务场景来进行取舍。</p></blockquote><h3 id="组件渲染⭐"><a href="#组件渲染⭐" class="headerlink" title="组件渲染⭐"></a>组件渲染⭐</h3><p>拿react举例，组件分割方面不要太深。需要控制组件的渲染，尤其是深层组件的render。</p><p>老生常谈的话题，我们可以一些方式来优化组件渲染</p><ul><li>声明周期控制 - 比如react的shouldComponentUpdate来控制组件渲染。</li><li>官网提供的api- PureComponent</li><li>控制注入组件的参数</li><li>分配组件唯一key</li></ul><p>没有必要的渲染是对性能的极大浪费。</p><h3 id="node-middleware"><a href="#node-middleware" class="headerlink" title="node middleware"></a>node middleware</h3><p>中文（node 中间件）</p><p>中间件主要是指封装所有Http请求细节处理的方法。一次Http请求通常包含很多工作，如记录日志、ip过滤、查询字符串、请求体解析、Cookie处理、权限验证、参数验证、异常处理等，但对于Web应用而言，并不希望接触到这么多细节性的处理，因此引入中间件来简化和隔离这些基础设施与业务逻辑之间的细节，让我们能够关注在业务的开发上，以达到提升开发效率的目的。</p><p>使用node middleware合并请求。减少请求次数。这种方式也是非常实用的。</p><h3 id="web-worker⭐"><a href="#web-worker⭐" class="headerlink" title="web worker⭐"></a>web worker⭐</h3><p>Web Worker 的作用，就是为 JavaScript 创造多线程环境，允许主线程创建 Worker 线程，将一些任务分配给后者运行。在主线程运行的同时，Worker 线程在后台运行，两者互不干扰。等到 Worker 线程完成计算任务，再把结果返回给主线程。这样的好处是，一些计算密集型或高延迟的任务，被 Worker 线程负担了，主线程（通常负责 UI 交互）就会很流畅，不会被阻塞或拖慢。</p><p>合理实用web worker可以优化复杂计算任务。</p><h3 id="缓存⭐"><a href="#缓存⭐" class="headerlink" title="缓存⭐"></a>缓存⭐</h3><p>缓存的原理就是更快读写的存储介质+减少IO+减少CPU计算=性能优化。而性能优化的第一定律就是：优先考虑使用缓存。</p><p>缓存的主要手段有：浏览器缓存、CDN、反向代理、本地缓存、分布式缓存、数据库缓存。</p><h3 id="GPU渲染⭐"><a href="#GPU渲染⭐" class="headerlink" title="GPU渲染⭐"></a>GPU渲染⭐</h3><p>每个网页或多或少都涉及到一些CSS动画，通常简单的动画对于性能的影响微乎其微，然而如果涉及到稍显复杂的动画，不当的处理方式会使性能问题变得十分突出。</p><p>像Chrome, FireFox, Safari, IE9+和最新版本的Opera都支持GPU加速，当它们检测到页面中某个DOM元素应用了某些CSS规则时就会开启。</p><p>虽然我们可能不想对元素应用3D变换，可我们一样可以开启3D引擎。例如我们可以用<code>transform: translateZ(0)</code> 来开启GPU加速 。</p><p>只对我们需要实现动画效果的元素应用以上方法，如果仅仅为了开启硬件加速而随便乱用，那是不合理的。</p><h3 id="Ajax可缓存"><a href="#Ajax可缓存" class="headerlink" title="Ajax可缓存"></a>Ajax可缓存</h3><p>Ajax在发送的数据成功后，为了提高页面的响应速度和用户体验，会把请求的URL和返回的响应结果保存在缓存内，当下一次调用Ajax发送相同的请求（URL和参数完全相同）时，它就会直接从缓存中拿数据。</p><p>在进行Ajax请求的时候，可以选择尽量使用get方法，这样可以使用客户端的缓存，提高请求速度。</p><h3 id="Resource-Hints"><a href="#Resource-Hints" class="headerlink" title="Resource Hints"></a>Resource Hints</h3><p>Resource Hints(资源预加载)是非常好的一种性能优化方法，可以大大降低页面加载时间，给用户更加流畅的用户体验。</p><p>现代浏览器使用大量预测优化技术来预测用户行为和意图，这些技术有预连接、资源与获取、资源预渲染等。</p><p>Resource Hints 的思路有如下两个：</p><ul><li>当前将要获取资源的列表</li><li>通过当前页面或应用的状态、用户历史行为或 session 预测用户行为及必需的资源</li></ul><p>实现Resource Hints的方法有很多种，可分为基于 link 标签的 DNS-prefetch、subresource、preload、 prefetch、preconnect、prerender，和本地存储 localStorage。</p><h3 id="SSR"><a href="#SSR" class="headerlink" title="SSR"></a>SSR</h3><p>渲染过程在服务器端完成，最终的渲染结果 HTML 页面通过 HTTP 协议发送给客户端，又被认为是‘同构’或‘通用’，如果你的项目有大量的detail页面，相互特别频繁，建议选择服务端渲染。</p><p>服务端渲染(SSR)除了SEO还有很多时候用作首屏优化，加快首屏速度，提高用户体验。但是对服务器有要求，网络传输数据量大，占用部分服务器运算资源。</p><p>Vue的Nuxt.js和React的next.js都是服务端渲染的方法。</p><h3 id="UNPKG"><a href="#UNPKG" class="headerlink" title="UNPKG"></a>UNPKG</h3><p>UNPKG是一个提供npm包进行CDN加速的站点，因此，可以将一些比较固定了依赖写入html模版中，从而提高网页的性能。首先，需要将这些依赖声明为external，以便webpack打包时不从node_modules中加载这些资源，配置如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">externals: &#123; <span class="string">&#x27;react&#x27;</span>: <span class="string">&#x27;React&#x27;</span> &#125;</span><br></pre></td></tr></table></figure><p>其次，你需要将所依赖的资源写在html模版中，这一步需要用到<a href="https://link.juejin.cn/?target=https://link.zhihu.com/?target=https://github.com/jantimon/html-webpack-plugin">html-webpack-plugin</a>。下面是一段示例：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;% if (htmlWebpackPlugin.options.node_env === &#x27;development&#x27;) &#123; %&gt;</span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/react@16.7.0/umd/react.development.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">&lt;% &#125; else &#123; %&gt;</span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/react@16.7.0/umd/react.production.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">&lt;% &#125; %&gt;</span><br></pre></td></tr></table></figure><p>这段代码需要注入node_env，以便在开发的时候能够获得更友好的错误提示。也可以选择一些比较自动的库，来帮助我们完成这个过程，比如<a href="https://link.juejin.cn/?target=https://link.zhihu.com/?target=https://www.npmjs.com/package/webpack-cdn-plugin">webpack-cdn-plugin</a>，或者<a href="https://link.juejin.cn/?target=https://link.zhihu.com/?target=https://github.com/mastilver/dynamic-cdn-webpack-plugin">dynamic-cdn-webpack-plugin</a>。</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>还有一些比较常用的优化方法我没有列举出来，例如将<strong>样式表放在顶部</strong>，<strong>将脚本放在底部</strong>，<strong>减少重绘</strong>，<strong>按需加载</strong>，<strong>模块化</strong>等。方法很多，对症下药才是关键。</p><p>借鉴了很多大佬最后总结出来的文章，希望自己和同为菜鸟的小伙伴可以永远怀着一颗学徒的心。</p></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Leslie Waong</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://lesliewaong.top/posts/616f4683.html">https://lesliewaong.top/posts/616f4683.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://lesliewaong.top" target="_blank">Leslie Waong</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/">性能优化</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/Lesliewaong/Lesliewaong.github.io/img/5.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/Lesliewaong/Lesliewaong.github.io/img/wx.png" target="_blank"><img class="post-qr-code-img" src="https://cdn.jsdelivr.net/gh/Lesliewaong/Lesliewaong.github.io/img/wx.png" alt="微信"></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/Lesliewaong/Lesliewaong.github.io/img/zfb.png" target="_blank"><img class="post-qr-code-img" src="https://cdn.jsdelivr.net/gh/Lesliewaong/Lesliewaong.github.io/img/zfb.png" alt="支付宝"></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/caa34564.html"><img class="prev-cover" src="https://cdn.jsdelivr.net/gh/Lesliewaong/Lesliewaong.github.io/img/15.webp" onerror='onerror=null,src="https://cdn.jsdelivr.net/gh/Lesliewaong/Lesliewaong.github.io/img/friend_404.gif"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">JS数组常用方法总结</div></div></a></div><div class="next-post pull-right"><a href="/posts/93b01391.html"><img class="next-cover" src="https://cdn.jsdelivr.net/gh/Lesliewaong/Lesliewaong.github.io/img/14.jpg" onerror='onerror=null,src="https://cdn.jsdelivr.net/gh/Lesliewaong/Lesliewaong.github.io/img/friend_404.gif"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">深入了解ES6的Set，WeakSet，Map和WeakMap</div></div></a></div></nav><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://cdn.jsdelivr.net/gh/Lesliewaong/Lesliewaong.github.io/img/avatar.jpg" onerror='this.onerror=null,this.src="https://cdn.jsdelivr.net/gh/Lesliewaong/Lesliewaong.github.io/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">Leslie Waong</div><div class="author-info__description">BUPT</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">46</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">99</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Lesliewaong"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Lesliewaong" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="tencent://AddContact/?fromId=45&amp;fromSubId=1&amp;subcmd=all&amp;uin=1138964397&amp;website=www.qtxml.cn" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">红雨漂泊泛起了回忆怎么潜</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96"><span class="toc-text">前端性能优化</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%87%8D%E8%A6%81%E6%80%A7"><span class="toc-text">重要性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9A%E4%BD%8D"><span class="toc-text">定位</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%80%E6%9C%AF%E4%B8%8A%E7%9A%84%E9%80%89%E6%8B%A9"><span class="toc-text">技术上的选择</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NetWork"><span class="toc-text">NetWork</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#webpack-bundle-analyzer"><span class="toc-text">webpack-bundle-analyzer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Performance"><span class="toc-text">Performance</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PerformanceNavigationTiming"><span class="toc-text">PerformanceNavigationTiming</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%93%E5%8C%85"><span class="toc-text">抓包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7"><span class="toc-text">性能测试工具</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%98%E5%8C%96"><span class="toc-text">优化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#tree-shaking"><span class="toc-text">tree shaking</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#split-chunks"><span class="toc-text">split chunks</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8B%86%E5%8C%85"><span class="toc-text">拆包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#gzip%E2%AD%90"><span class="toc-text">gzip⭐</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BE%E7%89%87%E5%8E%8B%E7%BC%A9%E2%AD%90"><span class="toc-text">图片压缩⭐</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BE%E7%89%87%E5%88%86%E5%89%B2"><span class="toc-text">图片分割</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sprite"><span class="toc-text">sprite</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CDN%E2%AD%90"><span class="toc-text">CDN⭐</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%87%92%E5%8A%A0%E8%BD%BD%E2%AD%90"><span class="toc-text">懒加载⭐</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#iconfont%E2%AD%90"><span class="toc-text">iconfont⭐</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E5%90%8E%E7%A7%BB"><span class="toc-text">逻辑后移</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%97%E6%B3%95%E5%A4%8D%E6%9D%82%E5%BA%A6%E2%AD%90"><span class="toc-text">算法复杂度⭐</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E6%B8%B2%E6%9F%93%E2%AD%90"><span class="toc-text">组件渲染⭐</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#node-middleware"><span class="toc-text">node middleware</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-worker%E2%AD%90"><span class="toc-text">web worker⭐</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%93%E5%AD%98%E2%AD%90"><span class="toc-text">缓存⭐</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GPU%E6%B8%B2%E6%9F%93%E2%AD%90"><span class="toc-text">GPU渲染⭐</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Ajax%E5%8F%AF%E7%BC%93%E5%AD%98"><span class="toc-text">Ajax可缓存</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Resource-Hints"><span class="toc-text">Resource Hints</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSR"><span class="toc-text">SSR</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UNPKG"><span class="toc-text">UNPKG</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-text">总结</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/bb028bb1.html" title="HTML语义化"><img src="https://cdn.jsdelivr.net/gh/Lesliewaong/Lesliewaong.github.io/img/1.jpg" onerror='this.onerror=null,this.src="https://cdn.jsdelivr.net/gh/Lesliewaong/Lesliewaong.github.io/img/friend_404.gif"' alt="HTML语义化"></a><div class="content"><a class="title" href="/posts/bb028bb1.html" title="HTML语义化">HTML语义化</a><time datetime="2022-03-04T03:14:22.000Z" title="发表于 2022-03-04 11:14:22">2022-03-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/58c5541d.html" title="跨域通信"><img src="https://cdn.jsdelivr.net/gh/Lesliewaong/Lesliewaong.github.io/img/7.jpg" onerror='this.onerror=null,this.src="https://cdn.jsdelivr.net/gh/Lesliewaong/Lesliewaong.github.io/img/friend_404.gif"' alt="跨域通信"></a><div class="content"><a class="title" href="/posts/58c5541d.html" title="跨域通信">跨域通信</a><time datetime="2022-03-03T11:10:23.000Z" title="发表于 2022-03-03 19:10:23">2022-03-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/6154ca16.html" title="从URL输入到页面展现到底发生什么？"><img src="https://cdn.jsdelivr.net/gh/Lesliewaong/Lesliewaong.github.io/img/14.jpg" onerror='this.onerror=null,this.src="https://cdn.jsdelivr.net/gh/Lesliewaong/Lesliewaong.github.io/img/friend_404.gif"' alt="从URL输入到页面展现到底发生什么？"></a><div class="content"><a class="title" href="/posts/6154ca16.html" title="从URL输入到页面展现到底发生什么？">从URL输入到页面展现到底发生什么？</a><time datetime="2022-03-03T05:14:52.000Z" title="发表于 2022-03-03 13:14:52">2022-03-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/2c5b9cd5.html" title="HTTP相关内容"><img src="https://cdn.jsdelivr.net/gh/Lesliewaong/Lesliewaong.github.io/img/4.jpg" onerror='this.onerror=null,this.src="https://cdn.jsdelivr.net/gh/Lesliewaong/Lesliewaong.github.io/img/friend_404.gif"' alt="HTTP相关内容"></a><div class="content"><a class="title" href="/posts/2c5b9cd5.html" title="HTTP相关内容">HTTP相关内容</a><time datetime="2022-03-02T03:11:12.000Z" title="发表于 2022-03-02 11:11:12">2022-03-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/78b84cab.html" title="Session、Cookie、sessionStorage、localStorage 详解及应用场景"><img src="https://cdn.jsdelivr.net/gh/Lesliewaong/Lesliewaong.github.io/img/9.webp" onerror='this.onerror=null,this.src="https://cdn.jsdelivr.net/gh/Lesliewaong/Lesliewaong.github.io/img/friend_404.gif"' alt="Session、Cookie、sessionStorage、localStorage 详解及应用场景"></a><div class="content"><a class="title" href="/posts/78b84cab.html" title="Session、Cookie、sessionStorage、localStorage 详解及应用场景">Session、Cookie、sessionStorage、localStorage 详解及应用场景</a><time datetime="2022-03-01T02:11:13.000Z" title="发表于 2022-03-01 10:11:13">2022-03-01</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2022 By Leslie Waong</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div></div><hr><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader={endLoading:()=>{document.body.style.overflow="auto",document.getElementById("loading-box").classList.add("loaded")},initLoading:()=>{document.body.style.overflow="",document.getElementById("loading-box").classList.remove("loaded")}};window.addEventListener("load",preloader.endLoading())</script><div class="js-pjax"><script>(()=>{const t=document.getElementById("twikoo-count"),o=()=>{twikoo.init(Object.assign({el:"#twikoo-wrap",envId:"https://twikoo-k8ctnwg8j-1138964397-qqcom.vercel.app/",region:""},null))},e=()=>{twikoo.getCommentsCount({envId:"https://twikoo-k8ctnwg8j-1138964397-qqcom.vercel.app/",region:"",urls:[window.location.pathname],includeReply:!1}).then((function(o){t.innerText=o[0].count})).catch((function(t){console.error(t)}))},n=(n=!1)=>{"object"==typeof twikoo?(o(),n&&t&&setTimeout(e,0)):getScript("https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js").then(()=>{o(),n&&t&&setTimeout(e,0)})};btf.loadComment(document.getElementById("twikoo-wrap"),n)})()</script></div><div class="aplayer no-destroy" data-id="6995412795" data-server="tencent" data-type="playlist" data-fixed="true" data-mini="true" data-listfolded="false" data-order="random" data-preload="auto" data-autoplay="true" muted></div><script defer id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script id="canvas_nest" defer color="0,0,255" opacity="0.7" zindex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!0,POWERMODE.mobile=!1,document.body.addEventListener("input",POWERMODE)</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-heart.min.js" async mobile="false"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors=["title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];var pjax=new Pjax({elements:'a:not([target="_blank"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!1,scrollRestoration:!1});document.addEventListener("pjax:send",(function(){if(window.removeEventListener("scroll",window.tocScrollFn),window.removeEventListener("scroll",scrollCollect),"object"==typeof preloader&&preloader.initLoading(),window.aplayers)for(let e=0;e<window.aplayers.length;e++)window.aplayers[e].options.fixed||window.aplayers[e].destroy();"object"==typeof typed&&typed.destroy();const e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode")})),document.addEventListener("pjax:complete",(function(){window.refreshFn(),document.querySelectorAll("script[data-pjax]").forEach(e=>{const t=document.createElement("script"),o=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach(e=>t.setAttribute(e.name,e.value)),t.appendChild(document.createTextNode(o)),e.parentNode.replaceChild(t,e)}),GLOBAL_CONFIG.islazyload&&window.lazyLoadInstance.update(),"function"==typeof chatBtnFn&&chatBtnFn(),"function"==typeof panguInit&&panguInit(),"function"==typeof gtag&&gtag("config","",{page_path:window.location.pathname}),"object"==typeof _hmt&&_hmt.push(["_trackPageview",window.location.pathname]),"function"==typeof loadMeting&&document.getElementsByClassName("aplayer").length&&loadMeting(),"object"==typeof Prism&&Prism.highlightAll(),"object"==typeof preloader&&preloader.endLoading()})),document.addEventListener("pjax:error",e=>{404===e.request.status&&pjax.loadUrl("/404.html")})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300,"hOffset":0,"vOffset":0},"mobile":{"show":true,"scale":1},"react":{"opacityDefault":0.7,"opacityOnHover":0.2},"log":false,"tagMode":false});</script></body></html>